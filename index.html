<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyTIFF: TinyTIFF - A lightweight C++ library for Writing and Reading TIFF-files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_tinytiff.png"/></td>
  <td id="projectalign">
   <div id="projectname">TinyTIFF
   </div>
   <div id="projectbrief">a lightweight C/C++ library for reading and writing TIFF files</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">TinyTIFF - A lightweight C++ library for Writing and Reading TIFF-files </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a lightweight C++ library that allows to read and write TIFF files. It only implements limited support for the features of TIFF. It was developed as a replacement for <a href="https://en.wikipedia.org/wiki/Libtiff">libTIFF</a> for some very specific cases, where performance in writing (and reading) is much more important than full feature support. TinyTIFF e.g. does not support compression. Also the multi-frame TIFF-support is taylored (actually that is one of the main reasons for this library) to writing sequence of equally dimensioned images fast. The currently supported features are:</p><ul>
<li>for WRITING (TinyTIFFWriter):<ul>
<li>TIFF-only (no BigTIFF), i.e. max. 4GB</li>
<li>multiple frames per file (actually this is the scope of this lib, to write such multi-page files fast), but with the limitation that all frames have the same dimension, data-type and number of samples. The latter allows for the desired speed optimizations!</li>
<li>uncompressed frames</li>
<li>one, or more samples per frame</li>
<li>data types: UINT, INT, FLOAT, 8-64-bit</li>
<li>photometric interpretations: Greyscale, RGB, including ALPHA information</li>
<li>planar (R1R2R3...G1G2G3...B1B2B3...) or chunky (R1G1B1R2G2B2R3G3B3...) data organization for multi-sample data</li>
<li>writes stripped TIFFs only, no tiled TIFFs</li>
</ul>
</li>
<li>for READING (TinyTIFFReader):<ul>
<li>TIFF-only (no BigTIFF), i.e. max. 4GB</li>
<li>uncompressed frames</li>
<li>one, or more samples per frame</li>
<li>data types: UINT, INT, FLOAT, 8-64bit</li>
<li>planar and chunky data organization, for multi-sample data</li>
<li>no suppoer for palleted images</li>
<li>stripped TIFFs only, tiling is not supported</li>
</ul>
</li>
</ul>
<p>This software is licensed under the term of the GNU Lesser General Public License 3.0 (LGPL 3.0) or above. See <a class="el" href="licensepage.html#licensesec">TinyTIFF: LGPL &gt;= 3.0</a> for details.</p>
<p>Some helpful links:</p><ul>
<li><a href="http://jkriege2.github.io/TinyTIFF/index.html">Online-Documentation (http://jkriege2.github.io/TinyTIFF/index.html)</a></li>
<li><a href="https://github.com/jkriege2/TinyTIFF">Source Code Repository (https://github.com/jkriege2/TinyTIFF)</a></li>
</ul>
<h1><a class="anchor" id="mainpagetinytiff_writer"></a>
TinyTIFFWriter</h1>
<h2><a class="anchor" id="mainpagetinytiff_writer_usage"></a>
TinyTIFFWriter: Usage</h2>
<p>The methods in this file allow to write TIFF files with limited capabilites, but very fast. Usually writing TIFF files with a library like libTIFF is relatively slow, when multiple images are written into a single file. The methods in this files overcome this problem by implementing a tiny writer lib that allows to write a TIFF file where all images have the same properties (size, bit depth, ...). This is a situation thet occurs e.g. in cases where a camera acquires a video that should be saved as TIFF file. The library works like this (write 50 32x32 pixel 8-bit images: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_tiny_t_i_f_f_writer_file.html">TinyTIFFWriterFile</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>=<a class="code hl_function" href="group__tinytiffwriter___c.html#ga520a39ba2d48c59d49059f9c4c838be9">TinyTIFFWriter_open</a>(<span class="stringliteral">&quot;myfil.tif&quot;</span>, 8, 1, 32, 32);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>) {</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint16_t</a> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>=0; <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>&lt;50; <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>++) {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint8_t</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">data</a>=<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">readImage</a>();</div>
<div class="line">        <a class="code hl_function" href="group__tinytiffwriter___c.html#ga1df3025eb5ade77792e35a63ec23e58e">TinyTIFFWriter_writeImage</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>, <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">data</a>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__tinytiffwriter___c.html#ga366c67ab9dfdfe17c68460607140e449">TinyTIFFWriter_close</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__tinytiffreader___c_x_x_html_ga84f6f53744a800ffe02de90da9b2f799"><div class="ttname"><a href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">TinyTIFFReader_readFrame</a></div><div class="ttdeci">void TinyTIFFReader_readFrame(TinyTIFFReaderFile *tif, Tout *buffer, uint16_t sample=0)</div><div class="ttdoc">template function that internally calls TinyTIFFReader_getSampleData() and copies the data into the s...</div><div class="ttdef"><b>Definition</b> tinytiffreader.hxx:88</div></div>
<div class="ttc" id="agroup__tinytiffwriter___c_html_ga1df3025eb5ade77792e35a63ec23e58e"><div class="ttname"><a href="group__tinytiffwriter___c.html#ga1df3025eb5ade77792e35a63ec23e58e">TinyTIFFWriter_writeImage</a></div><div class="ttdeci">int TinyTIFFWriter_writeImage(TinyTIFFWriterFile *tiff, const void *data)</div><div class="ttdoc">Write a new image to the give TIFF file, in chunky configuration, expects the data to be chunky too....</div><div class="ttdef"><b>Definition</b> tinytiffwriter.c:1080</div></div>
<div class="ttc" id="agroup__tinytiffwriter___c_html_ga366c67ab9dfdfe17c68460607140e449"><div class="ttname"><a href="group__tinytiffwriter___c.html#ga366c67ab9dfdfe17c68460607140e449">TinyTIFFWriter_close</a></div><div class="ttdeci">void TinyTIFFWriter_close(TinyTIFFWriterFile *tiff)</div><div class="ttdoc">close a given TIFF file</div><div class="ttdef"><b>Definition</b> tinytiffwriter.c:1085</div></div>
<div class="ttc" id="agroup__tinytiffwriter___c_html_ga520a39ba2d48c59d49059f9c4c838be9"><div class="ttname"><a href="group__tinytiffwriter___c.html#ga520a39ba2d48c59d49059f9c4c838be9">TinyTIFFWriter_open</a></div><div class="ttdeci">TinyTIFFWriterFile * TinyTIFFWriter_open(const char *filename, uint16_t bitsPerSample, enum TinyTIFFWriterSampleFormat sampleFormat, uint16_t samples, uint32_t width, uint32_t height, enum TinyTIFFWriterSampleInterpretation sampleInterpretation)</div><div class="ttdoc">create a new TIFF file</div><div class="ttdef"><b>Definition</b> tinytiffwriter.c:693</div></div>
<div class="ttc" id="astruct_tiny_t_i_f_f_writer_file_html"><div class="ttname"><a href="struct_tiny_t_i_f_f_writer_file.html">TinyTIFFWriterFile</a></div><div class="ttdoc">this struct represents a TIFF file</div><div class="ttdef"><b>Definition</b> tinytiffwriter.c:89</div></div>
</div><!-- fragment --><h2><a class="anchor" id="mainpagetinytiff_writer_multisample"></a>
TinyTIFFWriter: Multi-Sample Images (e.g. RGB)</h2>
<p>You can also store multi-sample images. Their interpretation has to be specified in the call to <code><a class="el" href="group__tinytiffwriter___c.html#ga520a39ba2d48c59d49059f9c4c838be9" title="create a new TIFF file">TinyTIFFWriter_open()</a></code>, e.g. for an RGB-image, use: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_tiny_t_i_f_f_writer_file.html">TinyTIFFWriterFile</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>=<a class="code hl_function" href="group__tinytiffwriter___c.html#ga520a39ba2d48c59d49059f9c4c838be9">TinyTIFFWriter_open</a>(<span class="stringliteral">&quot;myfil.tif&quot;</span>, 8, 3, 32, 32, <a class="code hl_enumvalue" href="group__tinytiffwriter___c.html#gga008ea17df48967f26c0817d43c1de117a5cb9b26472e9cef4849b8fd6a617e465">TinyTIFFWriter_RGB</a>);</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>) {</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint16_t</a> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>=0; <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>&lt;50; <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>++) {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint8_t</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">data</a>=<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">readImage</a>();</div>
<div class="line">        <a class="code hl_function" href="group__tinytiffwriter___c.html#ga32cf28a2d7a485e7f4ddcccd6bffd1ed">TinyTIFFWriter_writeImageMultiSample</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>, <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">data</a>, <a class="code hl_enumvalue" href="group__tinytiffwriter.html#ggadfd20db5e9479d4b0ef30a6e055e4073adfc650b2bb47f1dca38e0b96303f1a14">TinyTIFF_Interleaved</a>, <a class="code hl_enumvalue" href="group__tinytiffwriter.html#ggadfd20db5e9479d4b0ef30a6e055e4073adfc650b2bb47f1dca38e0b96303f1a14">TinyTIFF_Interleaved</a>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__tinytiffwriter___c.html#ga366c67ab9dfdfe17c68460607140e449">TinyTIFFWriter_close</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tif</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__tinytiffwriter___c_html_ga32cf28a2d7a485e7f4ddcccd6bffd1ed"><div class="ttname"><a href="group__tinytiffwriter___c.html#ga32cf28a2d7a485e7f4ddcccd6bffd1ed">TinyTIFFWriter_writeImageMultiSample</a></div><div class="ttdeci">int TinyTIFFWriter_writeImageMultiSample(TinyTIFFWriterFile *tiff, const void *data, enum TinyTIFFSampleLayout inputOrganisation, enum TinyTIFFSampleLayout outputOrganization)</div><div class="ttdoc">write a new image to the give TIFF file. the image ist stored in separate planes or planar configurat...</div><div class="ttdef"><b>Definition</b> tinytiffwriter.c:953</div></div>
<div class="ttc" id="agroup__tinytiffwriter___c_html_gga008ea17df48967f26c0817d43c1de117a5cb9b26472e9cef4849b8fd6a617e465"><div class="ttname"><a href="group__tinytiffwriter___c.html#gga008ea17df48967f26c0817d43c1de117a5cb9b26472e9cef4849b8fd6a617e465">TinyTIFFWriter_RGB</a></div><div class="ttdeci">@ TinyTIFFWriter_RGB</div><div class="ttdef"><b>Definition</b> tinytiffwriter.h:105</div></div>
<div class="ttc" id="agroup__tinytiffwriter_html_ggadfd20db5e9479d4b0ef30a6e055e4073adfc650b2bb47f1dca38e0b96303f1a14"><div class="ttname"><a href="group__tinytiffwriter.html#ggadfd20db5e9479d4b0ef30a6e055e4073adfc650b2bb47f1dca38e0b96303f1a14">TinyTIFF_Interleaved</a></div><div class="ttdeci">@ TinyTIFF_Interleaved</div><div class="ttdef"><b>Definition</b> tinytiff_defs.h:74</div></div>
</div><!-- fragment --><p>Note, that <code><a class="el" href="group__tinytiffwriter___c.html#ga1df3025eb5ade77792e35a63ec23e58e" title="Write a new image to the give TIFF file, in chunky configuration, expects the data to be chunky too....">TinyTIFFWriter_writeImage()</a></code> expects the image data in the given buff <code>data</code> is given in interleaved order, i.e. <code>R1G1B1R2G2B2R3G3B3...</code> and writes it out in the same order. If you specify more or less samples, the same rules apply. You can use the extended method <code><a class="el" href="group__tinytiffwriter___c.html#ga32cf28a2d7a485e7f4ddcccd6bffd1ed" title="write a new image to the give TIFF file. the image ist stored in separate planes or planar configurat...">TinyTIFFWriter_writeImageMultiSample()</a></code> if your data is not in chunky format, or you want to write the data out in planar form, instead of chunky (e.g. to make the data readable by TinyTIFFReader.</p>
<p>Also it is possibly to specify that one of the extra channels ahall be used as ALPHA information. then you need to call <code>TinyTIFFWriter_open(..., TinyTIFFWriter_RGBA)</code> or <code>TinyTIFFWriter_open(..., TinyTIFFWriter_GreyscaleAndAlpha)</code>. All samples additional to the ones covered by the interpretation flag are treated as extraSamples with unspecified type (see TIFF specification for details).</p>
<h2><a class="anchor" id="mainpagetinytiff_writer_howitworks"></a>
TinyTIFFWriter: How it Works</h2>
<p>The images are written in big- or little-endian according to your system. The TIFF header is set accordingly, so we do not need to shuffle around bytes when writing, but the created TIFF file may differ from hardware system to hardware system, although the same data is written (once in little-endian, once in big-endian). Currently this library saves all images as unsigned int, but with given bit-depth (8, 16, 32 or 64). Also this library explicitly writes a resolution of 1 in both directions.</p>
<p>Internally this library works like this: <a class="el" href="group__tinytiffwriter___c.html#ga520a39ba2d48c59d49059f9c4c838be9" title="create a new TIFF file">TinyTIFFWriter_open()</a> will basically only initialize the internal datastructures and write the TIFF header. It also determines the byte order used by the system and sets the TIFF header acordingly. As the image size is known, the size of every image in the file can be predetermined (we assume a maximum number of TIFF directory entries). The size will be:</p>
<pre class="fragment">      MAX_HEADER_ENTRIES*12 + SOME_FREE_SPACE + WIDTH*HEIGHT*SAMPLES(BITS_PER_SAMPLES/8)
      ---------------------------------------   ----------------------------------------
          directory/image description data                 image data
</pre><p>The free space, indicated as SOME_FREE_SPACE is used to store contents of extended fields, like RATIONAL or ARRAY fields. Every image in the file will have this size and unused bytes are set to 0x00. <a class="el" href="group__tinytiffwriter___c.html#ga1df3025eb5ade77792e35a63ec23e58e" title="Write a new image to the give TIFF file, in chunky configuration, expects the data to be chunky too....">TinyTIFFWriter_writeImage()</a> then works like this: The image description data is first assembled in memory, then the complete image description data and the complete image data is written to the file all together. This reduces the number of file access operations and writes the data in two reltively large chunks which allows the operating system to properly optimize file access. Finally this method will save the position of the NEXT_IFD_OFFSET field in the image header. The NEXT_IFD_OFFSET field is filled with the adress of the next potential image. Finally the method <a class="el" href="group__tinytiffwriter___c.html#ga366c67ab9dfdfe17c68460607140e449" title="close a given TIFF file">TinyTIFFWriter_close()</a> will write 0x00000000 into the NEXT_IFD_OFFSET of the last image (as saved above) which ends the list of images in the file. This ansatz for writing TIFF files is only about a factor of 2 slower than directly writing binary data into a file. In addition the time needed to write an image stays equal also when writing many images, which is NOT the case for libtiff.</p>
<h2><a class="anchor" id="mainpagetinytiff_writer_benchmarks"></a>
TinyTIFFWriter: Benchmarks</h2>
<p>The library was developed due to a problem with libTIFF, when a lot (&gt;1000) frames are written into a TIFF-file. LibTIFF does not need constant time per frame (i.e. the time to write a multi-frame TIFF grows linearly with the number of frames), but the time to write a frame increases with the number of frames. The following performance measurement shows this. It was acquired using <code>tinytiffwriter_speedtest</code> from this repository and shows the average time required to write one frame (64x64x pixels, 16-bit integer) out of a number (10, 100, 1000, ...) of frames. It compares the performance of libTIFF, TinyTIFFWriter and simply writing the dtaa using <code><a class="el" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799" title="template function that internally calls TinyTIFFReader_getSampleData() and copies the data into the s...">fwrite()</a></code> ("RAW"). It was acquired on an Ryzen 5 3600+, Win10, 32-bit Release-build, writing onto a Harddisk (not a SSD)</p>
<div class="image">
<img src="tinytiffwriter_libtiff_raw_comparison_numimages.png" alt=""/>
</div>
<p>For a microscope developed during my PhD thesis, it was necessary to write 100000 frames and more with acceptable duration. Therefore libTIFF was unusable and TinyTIFFWriter was developed. As can be seen in the graph above. The performance of TinyTIFFWriter and <code><a class="el" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799" title="template function that internally calls TinyTIFFReader_getSampleData() and copies the data into the s...">fwrite()</a></code>/RAW is comparable, whereas the performance of LibTIFF falls off towards large files.</p>
<p>The following image shows another performance measurement, this time for different frame sizes (64x64-4096x4096, acquired on an Ryzen 5 3600+, Win10, 32-bit Release-build, writing onto a Harddisk (not a SSD)):</p>
<div class="image">
<img src="tinytiffwriter_libtiff_raw_comparison_imagesizes.png" alt=""/>
</div>
<p>This suggests that the performance of TinyTIFFWriter and <code><a class="el" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799" title="template function that internally calls TinyTIFFReader_getSampleData() and copies the data into the s...">fwrite()</a></code> are comparable for all image sizes. For larger images, also the performance of libTIFF is in the same range, whereas for small images, libTIFF falls off somewhat.</p>
<h1><a class="anchor" id="mainpagetinytiff_reader"></a>
TinyTIFFReader</h1>
<h1><a class="anchor" id="mainpagetinytiff_reader_usage"></a>
TinyTIFFReader: Usage</h1>
<p>The following example code reads all frames in a TIFF: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_tiny_t_i_f_f_reader_file.html">TinyTIFFReaderFile</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>=<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">NULL</a>;</div>
<div class="line"><a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>=<a class="code hl_function" href="group__tinytiffreader___c.html#ga531fcfcd39bb30904aec22b7758e22d3">TinyTIFFReader_open</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">filename</a>); </div>
<div class="line"> <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>) { </div>
<div class="line">     std::cout&lt;&lt;<span class="stringliteral">&quot;    ERROR reading (not existent, not accessible or no TIFF file)\n&quot;</span>; </div>
<div class="line"> } <span class="keywordflow">else</span> { </div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code hl_function" href="group__tinytiffreader___c.html#ga727c125b1285000f9efd1d438925f2a6">TinyTIFFReader_wasError</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>)) {</div>
<div class="line">       std::cout&lt;&lt;<span class="stringliteral">&quot;   ERROR:&quot;</span>&lt;&lt;<a class="code hl_function" href="group__tinytiffreader___c.html#gad23c48c252bc868866ea780ed0085eac">TinyTIFFReader_getLastError</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; </div>
<div class="line">     } <span class="keywordflow">else</span> {</div>
<div class="line">         std::cout&lt;&lt;<span class="stringliteral">&quot;    ImageDescription:\n&quot;</span>&lt;&lt; <a class="code hl_function" href="group__tinytiffreader___c.html#gae47e7d028d73236ee215deea91c50030">TinyTIFFReader_getImageDescription</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>) &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; </div>
<div class="line">         <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> frames=<a class="code hl_function" href="group__tinytiffreader___c.html#ga842c2b749f7c160a2dba1999476fcf1d">TinyTIFFReader_countFrames</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>); </div>
<div class="line">         std::cout&lt;&lt;<span class="stringliteral">&quot;    frames: &quot;</span>&lt;&lt;frames&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; </div>
<div class="line">         <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>=0; </div>
<div class="line">         <span class="keywordflow">if</span> (<a class="code hl_function" href="group__tinytiffreader___c.html#ga727c125b1285000f9efd1d438925f2a6">TinyTIFFReader_wasError</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>)) {</div>
<div class="line">           std::cout&lt;&lt;<span class="stringliteral">&quot;   ERROR:&quot;</span>&lt;&lt;<a class="code hl_function" href="group__tinytiffreader___c.html#gad23c48c252bc868866ea780ed0085eac">TinyTIFFReader_getLastError</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; </div>
<div class="line">         } <span class="keywordflow">else</span> {</div>
<div class="line">             <span class="keywordflow">do</span> { </div>
<div class="line">                 <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> width=<a class="code hl_function" href="group__tinytiffreader___c.html#ga7f10c63a9414173c585d3c1e9a234e68">TinyTIFFReader_getWidth</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>); </div>
<div class="line">                 <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> height=<a class="code hl_function" href="group__tinytiffreader___c.html#gaf633446099dec2640c474a9ffd317582">TinyTIFFReader_getHeight</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>); </div>
<div class="line">                 <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint16_t</a> samples=<a class="code hl_function" href="group__tinytiffreader___c.html#ga66c223345ce86b9a682546b4520b6c1c">TinyTIFFReader_getSamplesPerPixel</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiff</a>);</div>
<div class="line">                 <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint16_t</a> bitspersample=<a class="code hl_function" href="group__tinytiffreader___c.html#ga1382e30a353f34e179894c51e4ab0c09">TinyTIFFReader_getBitsPerSample</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiff</a>, 0);</div>
<div class="line">                 <span class="keywordtype">bool</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">ok</a>=<span class="keyword">true</span>;</div>
<div class="line">                 std::cout&lt;&lt;<span class="stringliteral">&quot;    size of frame &quot;</span>&lt;&lt;<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frame</a>&lt;&lt;<span class="stringliteral">&quot;: &quot;</span>&lt;&lt;width&lt;&lt;<span class="stringliteral">&quot;x&quot;</span>&lt;&lt;height&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; </div>
<div class="line">                 std::cout&lt;&lt;<span class="stringliteral">&quot;    each pixel has &quot;</span>&lt;&lt;samples&lt;&lt;<span class="stringliteral">&quot; samples with &quot;</span>&lt;&lt;bitspersample&lt;&lt;<span class="stringliteral">&quot; bits each&quot;</span>\<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">n</a><span class="stringliteral">&quot;; </span></div>
<div class="line"><span class="stringliteral">                 if (ok) { </span></div>
<div class="line"><span class="stringliteral">                     frame++; </span></div>
<div class="line"><span class="stringliteral">                     // allocate memory for 1 sample from the image</span></div>
<div class="line"><span class="stringliteral">                     uint8_t* image=(uint8_t*)calloc(width*height, bitspersample/8);  </span></div>
<div class="line"><span class="stringliteral">                     </span></div>
<div class="line"><span class="stringliteral">                     for (uint16_t sample=0; sample&lt;samples; sample++) {</span></div>
<div class="line"><span class="stringliteral">                         // read the sample</span></div>
<div class="line"><span class="stringliteral">                         TinyTIFFReader_getSampleData(tiffr, image, sample); </span></div>
<div class="line"><span class="stringliteral">                         if (TinyTIFFReader_wasError(tiffr)) { ok=false; std::cout&lt;&lt;&quot;</span>   <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">ERROR</a>:<span class="stringliteral">&quot;&lt;&lt;TinyTIFFReader_getLastError(tiffr)&lt;&lt;&quot;</span>\<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">n</a><span class="stringliteral">&quot;; break; } </span></div>
<div class="line"><span class="stringliteral">                     </span></div>
<div class="line">                         // HERE WE CAN DO SOMETHING WITH THE SAMPLE FROM THE IMAGE </div>
<div class="line">                         // IN image (ROW-MAJOR!)</div>
<div class="line">                         // Note: That you may have to typecast the array image to the</div>
<div class="line">                         // datatype used in the TIFF-file. You can get the size of each</div>
<div class="line">                         // sample in bits by calling TinyTIFFReader_getBitsPerSample() and</div>
<div class="line">                         // the datatype by calling TinyTIFFReader_getSampleFormat().</div>
<div class="line">                         </div>
<div class="line">                     }</div>
<div class="line">                     </div>
<div class="line">                     free(image); </div>
<div class="line">                 } </div>
<div class="line">             } while (TinyTIFFReader_readNext(tiffr)); // iterate over all frames</div>
<div class="line">             std::cout&lt;&lt;&quot;    <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">read</a> <span class="stringliteral">&quot;&lt;&lt;frame&lt;&lt;&quot;</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">frames\n</a><span class="stringliteral">&quot;; </span></div>
<div class="line"><span class="stringliteral">         }</span></div>
<div class="line"><span class="stringliteral">     }</span></div>
<div class="line"><span class="stringliteral"> }   </span></div>
<div class="line"><span class="stringliteral"> TinyTIFFReader_close(tiffr); </span></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga1382e30a353f34e179894c51e4ab0c09"><div class="ttname"><a href="group__tinytiffreader___c.html#ga1382e30a353f34e179894c51e4ab0c09">TinyTIFFReader_getBitsPerSample</a></div><div class="ttdeci">uint16_t TinyTIFFReader_getBitsPerSample(TinyTIFFReaderFile *tiff, int sample)</div><div class="ttdoc">return the bits per sample of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:986</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga531fcfcd39bb30904aec22b7758e22d3"><div class="ttname"><a href="group__tinytiffreader___c.html#ga531fcfcd39bb30904aec22b7758e22d3">TinyTIFFReader_open</a></div><div class="ttdeci">TinyTIFFReaderFile * TinyTIFFReader_open(const char *filename)</div><div class="ttdoc">open TIFF file for reading</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:878</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga66c223345ce86b9a682546b4520b6c1c"><div class="ttname"><a href="group__tinytiffreader___c.html#ga66c223345ce86b9a682546b4520b6c1c">TinyTIFFReader_getSamplesPerPixel</a></div><div class="ttdeci">uint16_t TinyTIFFReader_getSamplesPerPixel(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">return the samples per pixel of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:993</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga727c125b1285000f9efd1d438925f2a6"><div class="ttname"><a href="group__tinytiffreader___c.html#ga727c125b1285000f9efd1d438925f2a6">TinyTIFFReader_wasError</a></div><div class="ttdeci">int TinyTIFFReader_wasError(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">returns TINYTIFF_TRUE (non-zero) when there was an error in the last function call,...</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:332</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga7f10c63a9414173c585d3c1e9a234e68"><div class="ttname"><a href="group__tinytiffreader___c.html#ga7f10c63a9414173c585d3c1e9a234e68">TinyTIFFReader_getWidth</a></div><div class="ttdeci">uint32_t TinyTIFFReader_getWidth(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">return the width of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:957</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga842c2b749f7c160a2dba1999476fcf1d"><div class="ttname"><a href="group__tinytiffreader___c.html#ga842c2b749f7c160a2dba1999476fcf1d">TinyTIFFReader_countFrames</a></div><div class="ttdeci">uint32_t TinyTIFFReader_countFrames(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">return the width of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:1002</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_gad23c48c252bc868866ea780ed0085eac"><div class="ttname"><a href="group__tinytiffreader___c.html#gad23c48c252bc868866ea780ed0085eac">TinyTIFFReader_getLastError</a></div><div class="ttdeci">const char * TinyTIFFReader_getLastError(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">returns a pointer to the last error message</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:327</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_gae47e7d028d73236ee215deea91c50030"><div class="ttname"><a href="group__tinytiffreader___c.html#gae47e7d028d73236ee215deea91c50030">TinyTIFFReader_getImageDescription</a></div><div class="ttdeci">const char * TinyTIFFReader_getImageDescription(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">return the image description of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:971</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_gaf633446099dec2640c474a9ffd317582"><div class="ttname"><a href="group__tinytiffreader___c.html#gaf633446099dec2640c474a9ffd317582">TinyTIFFReader_getHeight</a></div><div class="ttdeci">uint32_t TinyTIFFReader_getHeight(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">return the height of the current frame</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:964</div></div>
<div class="ttc" id="astruct_tiny_t_i_f_f_reader_file_html"><div class="ttname"><a href="struct_tiny_t_i_f_f_reader_file.html">TinyTIFFReaderFile</a></div><div class="ttdef"><b>Definition</b> tinytiffreader.c:146</div></div>
</div><!-- fragment --><p>This simplified example reads the first sample from the first frame in a TIFF file: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_tiny_t_i_f_f_reader_file.html">TinyTIFFReaderFile</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>=<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">NULL</a>;</div>
<div class="line"><a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>=<a class="code hl_function" href="group__tinytiffreader___c.html#ga531fcfcd39bb30904aec22b7758e22d3">TinyTIFFReader_open</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">filename</a>); </div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>) { </div>
<div class="line">     std::cout&lt;&lt;<span class="stringliteral">&quot;    ERROR reading (not existent, not accessible or no TIFF file)\n&quot;</span>; </div>
<div class="line">} <span class="keywordflow">else</span> { </div>
<div class="line">     <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> width=<a class="code hl_function" href="group__tinytiffreader___c.html#ga7f10c63a9414173c585d3c1e9a234e68">TinyTIFFReader_getWidth</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>); </div>
<div class="line">     <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint32_t</a> height=<a class="code hl_function" href="group__tinytiffreader___c.html#gaf633446099dec2640c474a9ffd317582">TinyTIFFReader_getHeight</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>);</div>
<div class="line">     <span class="keyword">const</span> <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint16_t</a> bitspersample=<a class="code hl_function" href="group__tinytiffreader___c.html#ga1382e30a353f34e179894c51e4ab0c09">TinyTIFFReader_getBitsPerSample</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiff</a>, 0);      </div>
<div class="line">     <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint8_t</a>* <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">image</a>=(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">uint8_t</a>*)<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">calloc</a>(width*height, bitspersample/8);  </div>
<div class="line">     <a class="code hl_function" href="group__tinytiffreader___c.html#ga7884d41742aa1b3052fce596a68498a5">TinyTIFFReader_getSampleData</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>, <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">image</a>, 0); </div>
<div class="line">             </div>
<div class="line">                         <span class="comment">// HERE WE CAN DO SOMETHING WITH THE SAMPLE FROM THE IMAGE </span></div>
<div class="line">                         <span class="comment">// IN image (ROW-MAJOR!)</span></div>
<div class="line">                         <span class="comment">// Note: That you may have to typecast the array image to the</span></div>
<div class="line">                         <span class="comment">// datatype used in the TIFF-file. You can get the size of each</span></div>
<div class="line">                         <span class="comment">// sample in bits by calling TinyTIFFReader_getBitsPerSample() and</span></div>
<div class="line">                         <span class="comment">// the datatype by calling TinyTIFFReader_getSampleFormat().</span></div>
<div class="line">             </div>
<div class="line">     <a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">free</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">image</a>); </div>
<div class="line"> } </div>
<div class="line"> <a class="code hl_function" href="group__tinytiffreader___c.html#ga465193e79ee70b9ce6dd37e011c6d0f2">TinyTIFFReader_close</a>(<a class="code hl_function" href="group__tinytiffreader___c_x_x.html#ga84f6f53744a800ffe02de90da9b2f799">tiffr</a>); </div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga465193e79ee70b9ce6dd37e011c6d0f2"><div class="ttname"><a href="group__tinytiffreader___c.html#ga465193e79ee70b9ce6dd37e011c6d0f2">TinyTIFFReader_close</a></div><div class="ttdeci">void TinyTIFFReader_close(TinyTIFFReaderFile *tiff)</div><div class="ttdoc">close a given TIFF file</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:931</div></div>
<div class="ttc" id="agroup__tinytiffreader___c_html_ga7884d41742aa1b3052fce596a68498a5"><div class="ttname"><a href="group__tinytiffreader___c.html#ga7884d41742aa1b3052fce596a68498a5">TinyTIFFReader_getSampleData</a></div><div class="ttdeci">int TinyTIFFReader_getSampleData(TinyTIFFReaderFile *tiff, void *buffer, uint16_t sample)</div><div class="ttdoc">read the given sample from the current frame into the given buffer, the byteorder is transformed to t...</div><div class="ttdef"><b>Definition</b> tinytiffreader.c:650</div></div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 26 2024 21:38:09 for TinyTIFF by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
